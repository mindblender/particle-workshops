<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 4: Going Beyond Devices | Particle Workshops</title>
    <meta name="description" content="Workshops designed to teach the basics of IoT development with the Particle ecosystem">
    
    
    <link rel="preload" href="/assets/css/7.styles.78510396.css" as="style"><link rel="preload" href="/assets/js/app.e9643173.js" as="script"><link rel="preload" href="/assets/js/1.8a4a4359.js" as="script"><link rel="prefetch" href="/assets/js/0.d37fd2cb.js"><link rel="prefetch" href="/assets/js/2.d1150d98.js"><link rel="prefetch" href="/assets/js/3.53f2115b.js"><link rel="prefetch" href="/assets/js/4.ac59cc7e.js"><link rel="prefetch" href="/assets/js/5.b15512ca.js"><link rel="prefetch" href="/assets/js/6.e37ad755.js">
    <link rel="stylesheet" href="/assets/css/7.styles.78510396.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Particle Workshops
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://particle.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Team
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><a href="https://github.com/particle-iot/particle-workshops" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://particle.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Team
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><a href="https://github.com/particle-iot/particle-workshops" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><a href="/docs/" class="sidebar-link">About Particle Workshops</a></li><li><a href="/docs/ch1.html" class="sidebar-link">Chapter 1: Claiming your device</a></li><li><a href="/docs/ch2.html" class="sidebar-link">Chapter 2: Get your badge to blinky!</a></li><li><a href="/docs/ch3.html" class="sidebar-link">Chapter 3: Input and sensor basics</a></li><li><a href="/docs/ch4.html" class="active sidebar-link">Chapter 4: Going Beyond Devices</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/ch4.html#exploring-the-particle-cli-and-cloud-api" class="sidebar-link">Exploring the Particle CLI and Cloud API</a></li><li class="sidebar-sub-header"><a href="/docs/ch4.html#exploring-integrations-with-ifttt" class="sidebar-link">Exploring Integrations with IFTTT</a></li><li class="sidebar-sub-header"><a href="/docs/ch4.html#getting-device-data-into-azure-iot" class="sidebar-link">Getting Device Data into Azure IoT</a></li></ul></li><li><a href="/docs/extra1.html" class="sidebar-link">Extra: Taking your Photon exploration further</a></li></ul></div><div class="page"><div class="content"><h1 id="chapter-4-going-beyond-devices"><a href="#chapter-4-going-beyond-devices" aria-hidden="true" class="header-anchor">#</a> Chapter 4: Going Beyond Devices</h1><table><thead><tr><th><strong>Project Goal</strong></th><th>Connect your badge to 3rd party services and &quot;backhaul&quot; sensor data to the cloud.</th></tr></thead><tbody><tr><td><strong>What you’ll learn</strong></td><td>How to work with the Particle CLI; Building integrations with IFTTT; Piping sensor data into the Azure IoT Hub.</td></tr><tr><td><strong>Tools you’ll need</strong></td><td>Particle Dev (Desktop IDE), a Particle Photon and #PartiBadge</td></tr><tr><td><strong>Time needed to complete</strong></td><td>30 minutes</td></tr></tbody></table><h2 id="exploring-the-particle-cli-and-cloud-api"><a href="#exploring-the-particle-cli-and-cloud-api" aria-hidden="true" class="header-anchor">#</a> Exploring the Particle CLI and Cloud API</h2><h3 id="the-particle-cli"><a href="#the-particle-cli" aria-hidden="true" class="header-anchor">#</a> The Particle CLI</h3><ol><li>If you haven't already, <a href="https://docs.particle.io/guide/tools-and-features/cli/photon/" target="_blank" rel="noopener noreferrer">install the Particle CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Open a terminal window and type the following command:</li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">bash</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span> <span class="token function">curl</span> -sL https://particle.io/install-cli <span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>Type <code>particle login</code> and enter your Particle account email and password when prompted.</li></ol><p><img src="/assets/img/particlelogin.14fc48ea.gif" alt></p><ol start="3"><li>Once you're logged in, type <code>particle list</code> to see your list of online devices.</li></ol><p><img src="/assets/img/particlelist.085a96a6.gif" alt></p><ol start="4"><li>The device we've been using for this workshop has 3 variables and two functions. Get the value of the <code>temp</code> variable with the command <code>particle get temp</code>.</li></ol><p><img src="/assets/img/temp.61c682e4.gif" alt></p><ol start="5"><li>We can also call one of the two functions to light up the yellow or blue LED button. Type the command <code>particle call &lt;your-device-name&gt; toggleB</code> in the terminal. Run the same command again to turn the light off.</li></ol><p><img src="/assets/img/call.a52345b6.gif" alt></p><p><img src="/assets/img/blinkyblue.296fa049.gif" alt></p><h3 id="the-particle-device-cloud-api"><a href="#the-particle-device-cloud-api" aria-hidden="true" class="header-anchor">#</a> The Particle Device Cloud API</h3><p>Behind the scenes, every interface that Particle provides to work with devices, from the console to, mobile apps, SDKs and the CLI talks through a RESTful Device Cloud API, which you can also call yourself, directly.</p><p><em>The next few steps assume you have cURL installed on your machine. If you don't have this command-line utility on your machine, you can download and install it <a href="https://curl.haxx.se/download.html" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or use a GUI-based tool like <a href="https://www.getpostman.com/" target="_blank" rel="noopener noreferrer">Postman<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</em></p><ol><li><p>First, you'll need to obtain an access token from the CLI. Type <code>particle token list</code> to view the tokens associated with your account. The first one listed is your <code>user</code> token, and can be used to access the Device Cloud API. If no tokens are listed, generate a new one with <code>particle token new</code>.</p></li><li><p>With your token and Device ID in hand, type the following cURL command into a terminal window, replacing the text below in <code>&lt; &gt;</code> with your information.</p></li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://api.particle.io/v1/devices?access_token<span class="token operator">=</span><span class="token operator">&lt;</span>your token<span class="token operator">&gt;</span>
</code></pre></div><p>By default, the response will generate a wall of text in your terminal. If you have Python 2.6+ installed on your machine, you can pipe the output to the <code>json.tool</code> and get pretty-printed JSON.</p><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://api.particle.io/v1/devices\?access_token\<span class="token operator">=</span><span class="token operator">&lt;</span>your token<span class="token operator">&gt;</span>
<span class="token operator">|</span> python -m json.tool
</code></pre></div><p><img src="/assets/img/curllist.d0d65fc2.gif" alt></p><ol start="3"><li><p>For this next command, you need the Device ID of the Photon attached to your badge. You can find that in the console or via the <code>particle list</code> CLI command.</p></li><li><p>Let's call the <code>toggleB</code> function using the Device Cloud API. Type the following, again replacing the text below in <code>&lt; &gt;</code> with your information.</p></li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> https://api.particle.io/v1/devices/3<span class="token operator">&lt;</span>device id<span class="token operator">&gt;</span>/toggleB \
     -d access_token<span class="token operator">=</span><span class="token operator">&lt;</span>your token<span class="token operator">&gt;</span>
</code></pre></div><p><img src="/assets/img/curlcall.3ab57029.gif" alt></p><p>With that, you've now explored all of the ways that you can interface with the Particle Device cloud and your connected devices! Now, let's go beyond the Particle ecosystem and explore some of the ways that you can integrate with other 3rd party services, and backhaul your data into other cloud services.</p><h2 id="exploring-integrations-with-ifttt"><a href="#exploring-integrations-with-ifttt" aria-hidden="true" class="header-anchor">#</a> Exploring Integrations with IFTTT</h2><p>IFTTT (If This, Then That) is a web-based services that allows you to create integrations via simple conditional statements, called applets. There are hundreds of pre-build services you can leverage, and first-class support for Particle devices. In this section, we're going to create an IFTTT integration that posts a tweet when you press a button on your badge.</p><ol><li>Start by heading over to <a href="https://ifttt.com" target="_blank" rel="noopener noreferrer">IFTTT<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and either login, or create a new account.</li></ol><p><img src="/assets/img/ifttt.9d29f5a2.png" alt></p><ol start="2"><li>After logging in, click &quot;New Applet&quot; in the top right of your dashboard.</li></ol><p><img src="/assets/img/newapplet.71f8dec8.png" alt></p><ol start="3"><li>Click the &quot;+this&quot; button.</li></ol><p><img src="/assets/img/ifthis.97cb425e.png" alt></p><ol start="4"><li>In the &quot;Search services&quot; input, type &quot;particle&quot; and click on the Particle card.</li></ol><p><img src="/assets/img/chooseservice.824f7028.png" alt></p><p><img src="/assets/img/chooseparticle.55d9e5c6.png" alt></p><ol start="5"><li>Click on the &quot;New event published&quot; card.</li></ol><p><img src="/assets/img/choosetrigger.c8d13bc1.png" alt></p><ol start="6"><li>In the trigger fields, set the event name as <code>button-pressed</code> the event contents to <code>red</code> and the Device name to the name of your device. Click &quot;create trigger&quot;</li></ol><p><img src="/assets/img/completetrigger.c58203cd.png" alt></p><ol start="7"><li>You've set up the trigger on the Particle end, now its time for the <strong>That</strong> portion of the setup. Click the &quot;+that&quot; button.</li></ol><p><img src="/assets/img/thenthat.5c372b0e.png" alt></p><ol start="8"><li>Select the &quot;Twitter&quot; card.</li></ol><p><img src="/assets/img/choosetwitter.8f0c7a21.png" alt></p><ol start="9"><li>Click the &quot;Post a tweet&quot; action card. You may be prompted to connect your Twitter account to IFTTT at this point. Follow the instructions provided to do so.</li></ol><p><img src="/assets/img/twitteraction.4dd3d0a7.png" alt></p><ol start="10"><li>For the tweet text, copy the following, or customize as you wish. The text in double-brackets ({{}}) is replacement text based on the input event from Particle. You can click &quot;Add ingredient&quot; to see what other fields are available to use. Click &quot;Create action&quot; when you're done.</li></ol><div class="language- extra-class"><pre class="language-text"><code>My #PartiBadge is tweeting! {{DeviceName}} published {{EventName}}
with data {{EventContents}}
</code></pre></div><p><img src="/assets/img/twitteractionfields.81991bc2.png" alt></p><ol start="11"><li>Click &quot;Finish&quot;</li></ol><p><img src="/assets/img/iftttreview.76780a22.png" alt></p><ol start="12"><li>You're all set! Toggle the switch to turn your action on if it isn't by default.</li></ol><p><img src="/assets/img/iftttfinal.bb9a8cca.png" alt></p><ol start="13"><li>Now, we need to modify our badge firmware to publish an event when the red button is pressed. Add the following to the <code>loop</code> function:</li></ol><div class="language-cpp extra-class"><pre class="language-cpp"><code>redButtonADebouncer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>redButtonADebouncer<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> HIGH<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>yellowLED<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>yellowLED<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Particle<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">&quot;button-pressed&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> MY_DEVICES<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="14"><li><p>Flash the firmware to your badge and press the red button a few times.</p></li><li><p>Head over to your Twitter account and see yout Particle-powered tweet! <em>Note: it may take a few minutes for IFTTT to pick up the event.</em></p></li></ol><p><img src="/assets/img/badgetweet.c674d54e.png" alt></p><h2 id="getting-device-data-into-azure-iot"><a href="#getting-device-data-into-azure-iot" aria-hidden="true" class="header-anchor">#</a> Getting Device Data into Azure IoT</h2></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/particle-iot/particle-workshops/edit/master/docs/ch4.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/ch3.html" class="prev">
          Chapter 3: Input and sensor basics
        </a></span><span class="next"><a href="/docs/extra1.html">
          Extra: Taking your Photon exploration further
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/1.8a4a4359.js" defer></script><script src="/assets/js/app.e9643173.js" defer></script>
  </body>
</html>
